---
layout: post
title: "[텐서플로우] 모델 저장"
categories: ml
---

그래프와 가중치를 통째로 저장합니다.

0. this unordered seed list will be replaced by toc as unordered list
{:toc}

## SavedModel 포맷

```python
model.save('saved_model/my_model')
```

`my_model` 하위에 아래와 같은 파일들이 생김

```
my_model
+-- assets
+-- saved_model.pb
+-- variables
```

저장된 모델로부터 로드

```python
new_model = tf.keras.models.load_model('saved_model/my_model')
```

## HDF5 포맷

`.h5` 확장자 지정시 HDF5 포맷으로 저장됨

```python
model.save('my_model.h5')
```

저장된 모델로부터 새로운 케라스 모델을 로드할 수 있음

```python
new_model = tf.keras.models.load_model('my_model.h5')
```

## 참조

- https://tensorflow.org/tutorials/keras/save_and_load
